
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>My Profile -  MetroShare</title>
        <link href="css/style.css" type="text/css" rel="stylesheet">
        <link href="css/font-awesome.min.css" type="text/css" rel="stylesheet">
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
        <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico">
        <script type="text/javascript">
            $(document).ready(function () {
                $("#navbar-mobile").hide();
                $(".navbar-dropdown-toggle").click(function ()
                {
                    $("#navbar-mobile").slideToggle(500);
                });
            });
        </script>
    </head>
    <body>

        <div class="container-fluid navbar-dropdown-toggle-container visible-mobile">
            <a href="#" class="navbar-dropdown-toggle"><i class="fa fa-2x fa-bars"></i></a>
        </div>

        <div class="container-fluid">
            <div class="navbar-secondary visible-desktop">
                <div class="container">
                    <ul>
                        <li class="left navbar-secondary-logo"><a href="index.html"><img src="images/favicon.ico" alt=""></a></li>
                        <li class="left"><a href="index.html">Statistics</a></li>
                        <li class="left"><a href="index.html">About</a></li>
                        <li class="right"><a href="profile.html" id="loginname">JohnDoe</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container-fluid navbar-secondary-container">
            <div class="container">
                <div class="navbar visible-desktop" id="navbar-desktop">
                    <ul>
                        <li><a href="index.html"><i class="fa fa-home"></i>Home</a></li>
                        <li><a href="index.html"><i class="fa fa-search"></i>Browse</a></li>
                        <li><a href="index.html"><i class="fa fa-upload"></i>Upload</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="navbar visible-mobile" id="navbar-mobile">
            <div class="container">
                <ul>
                    <form>
                        <li><input type="text" name="username" placeholder="Username" required></li>
                        <li><input type="password" name="password" placeholder="Password" required></li>
                        <li><input type="submit" value="Log in"></li>
                    </form>
                    <li><a href="index.html"><i class="fa fa-home"></i>Home</a></li>
                    <li><a href="index.html"><i class="fa fa-search"></i>Browse</a></li>
                    <li><a href="index.html"><i class="fa fa-upload"></i>Upload</a></li>
                </ul>
            </div>
        </div>

        <div class="container-fluid" style="background-color: #73b9ff; padding-top: 25px;">
            <div class="container">
                <div class="col-4" id="login">
                    <img src="http://www.technologybloggers.org/wp-content/uploads/2012/04/Gravatar-Logo-300x300.jpg" alt="" style="width: 50%; display:block; margin: auto;">
                </div>
                <div class="col-4">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <h3>My Folders</h3>
                        </div>

                        <div class="panel-body">
                            <ul>
                                <li>Trees</li>
                                <li>Landscapes</li>
                                <li>Sky</li>
                                <li>Birds</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="col-4">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <h3>Friends</h3>
                        </div>

                        <div class="panel-body" id="friends">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="col-12">
                <div id="media">
                </div>
            </div>
        </div>

        <div id="matti"></div>

        <footer class="container-fluid">
            <div class="container">
                <ul class="col-4">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Browse</a></li>
                    <li><a href="#">Upload</a></li>
                    <li><a href="#">About</a></li>
                </ul>

                <ul class="col-4">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Browse</a></li>
                    <li><a href="#">Upload</a></li>
                    <li><a href="#">About</a></li>
                </ul>

                <ul class="col-4">
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Browse</a></li>
                    <li><a href="#">Upload</a></li>
                    <li><a href="#">About</a></li>
                </ul>
            </div>
        </footer>

        <table id="tables">

        </table>

        <script>
            var fadeElementOut = function (event) {
                $(e.target).fadeOut(500);
            };
        </script>

        <script type="text/javascript">
            $(document).ready(function (event) {
                $.ajax({
                    type: "GET",
                    url: "http://localhost:8080/MetroShare/webresources/users/matti",
                    success: function (data, textStatus, xhr) {
                        var jsondata = JSON.parse(data);
                        var matti = $('#matti');

                        console.log(jsondata[0]);

                        // Example how to insert user name to page after load 
                        var h3 = document.createElement("H3");
                        h3.innerHTML = jsondata[0].login;
                        h3.style.textAlign = "center";
                        var loginArea = $('#login');
                        loginArea.append(h3);


                        // Adding user's photos
                        for (i = 0; i < jsondata[0].media.length; i++) {
                            var col4 = document.createElement("DIV");
                            col4.setAttribute("class", "col-4");
                            var imageholder = document.createElement("DIV");
                            imageholder.setAttribute("class", "imageholder");
                            var img = document.createElement("IMG");
                            img.src = "http://nemanjakovacevic.net/wp-content/uploads/2013/07/placeholder.png"; //TODO fix path
                            img.classList.add("image");
                            imageholder.appendChild(img);
                            var caption = document.createElement("DIV");
                            caption.setAttribute("class", "caption");
                            caption.innerText = jsondata[0].media[i].title;
                            if (jsondata[0].media[i].nsfw == true) {
                                img.classList.add("nsfw");
                                img.setAttribute("onclick", "unBlur(this)");
                                caption.innerText = jsondata[0].media[i].title + "\nNSFW\n(Click to see content)";
                            }
                            imageholder.appendChild(caption);
                            col4.appendChild(imageholder);
                            document.querySelector("#media").appendChild(col4);
                            console.log(col4);
                        }

                        // Friends
                        var frul = document.createElement("UL");
                        for (i = 0; i < jsondata[0].friends.length; i++) {
                            var frli = document.createElement("LI");
                            frli.innerText = jsondata[0].friends[i].friend;
                            frul.appendChild(frli);
                        }
                        document.querySelector("#friends").appendChild(frul);
                        console.log(frul);


                        // Example how to modify existing data
                        console.log($("#loginname").text()); // first it is johndoe
                        $("#loginname").text(jsondata[0].login);
                        console.log($("#loginname").text()); // then changed to json value login 

                        arrayToTable(jsondata[0].friends[0]);
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log("Error: " + errorThrown);
                    }
                });
            });
        </script>

        <script type="text/javascript">
            function unBlur(nsfwobject) {
                nsfwobject.classList.remove("nsfw")";
            }
        </script>

        <script type="text/javascript">
            function arrayToTable(arrayToBeTable) {
                console.log(arrayToBeTable);
                var table = document.getElementById("tables");
                table.innerHTML = '';
                var thead = document.createElement("THEAD");
                var tbody = document.createElement("TBODY");
                var tr = document.createElement("TR");
                for (i = 0; i < arrayToBeTable.length; i++) {
                    if (i == 0) {
                        for (var header in arrayToBeTable[i]) {
                            var th = document.createElement("TH");
                            th.textContent = arrayToBeTable[i][header];
                            tr.appendChild(th);
                        }
                        thead.appendChild(tr);
                        table.appendChild(thead);
                    } else {
                        tr = document.createElement("TR");
                        for (var value in arrayToBeTable[i]) {
                            var th = document.createElement("TD");
                            th.textContent = arrayToBeTable[i][value];
                            tr.appendChild(th);
                        }
                        tbody.appendChild(tr);
                        table.appendChild(tbody);
                    }
                }
            }
        </script>


    </body>
</html>

