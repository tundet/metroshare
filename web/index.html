<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Testpage Metroshare</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
        <!--<script type="text/javascript" src="JS/Utils.js"></script>-->
        <style>
            li {display: inline-block;}
        </style>
    </head>
    <body>
        <form id="login-form" method="post" action="">
            <input type="text" name="username" placeholder="Username">
            <input type="password" name="password" placeholder="Password">
            <input type="submit" value="Log in">
        </form>
        <div>
            
            <h4>PAGES</h4>
            <ul>
                <li>
                    <form id="profile" action="profile.html">
                        <button type="submit">Profile page</button>
                    </form>
                </li>
            </ul>
            
            <h4>GET ADMIN LISTS AS JSONS</h4>
            <ul>
                <li>
                    <!-- GET ADMIN USERLIST -->
                    <form id="admin-users" method="post" action="">
                        <button type="submit">Get Users!</button>
                    </form>
                </li>

                <li>
                    <!-- GET ADMIN COMMENTLIST -->
                    <form id="admin-comments" method="post" action="">
                        <button type="submit">Get Comments!</button>
                    </form>
                </li>

                <li>
                    <!-- GET ADMIN MEDIALIST -->
                    <form id="admin-medias" method="post" action="">
                        <button type="submit">Get Medias!</button>
                    </form>
                </li>

                <li>
                    <!-- GET ADMIN TAGLIST -->
                    <form id="admin-tags" method="post" action="">
                        <button type="submit">Get Tags!</button>
                    </form>
                </li>
            </ul>           
        </div>

        <table id="tables">

        </table>

        <!--<script type="text/javascript">
            $.get("http://localhost:8080/MetroShare/webresources/users/matti/activity", function (data) {
                alert("Loaded user: " + data.activity);
            });
        </script>-->

        <script type="text/javascript">
            $("#login-form").submit(function (event) {
                event.preventDefault();

                $.ajax({
                    type: "POST",
                    url: "http://localhost:8080/MetroShare/webresources/login",
                    data: $("#login-form").serialize(),
                    success: function (data, textStatus, xhr) {
                        alert(data);
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log("Error: " + errorThrown);
                    }
                });
            });
        </script>

        <script type="text/javascript">
            $("#admin-users").submit(function (event) {
                event.preventDefault();

                $.ajax({
                    type: "POST",
                    url: "http://localhost:8080/MetroShare/webresources/admin/users",
                    data: $("#admin-users").serialize(),
                    success: function (data, textStatus, xhr) {
                        var jsondata = JSON.parse(data);
                        var a = [];
                        var b = [];
                        for (var data in jsondata.users[0]) {
                            b.push(data);
                        }
                        a.push(b);
                        for (var json in jsondata.users) {
                            var b = [];
                            for (var data in jsondata.users[json]) {
                                b.push(jsondata.users[json][data]);
                            }
                            a.push(b);
                        }
                        console.log(a);
                        arrayToTable(a);

                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log("Error: " + errorThrown);
                    }
                });
            });
        </script>

        <script type="text/javascript">
            $("#admin-comments").submit(function (event) {
                event.preventDefault();

                $.ajax({
                    type: "POST",
                    url: "http://localhost:8080/MetroShare/webresources/admin/comments",
                    data: $("#admin-comments").serialize(),
                    success: function (data, textStatus, xhr) {
                        var jsondata = JSON.parse(data);
                        var a = [];
                        var b = [];
                        for (var data in jsondata.comments[0]) {
                            b.push(data);
                        }
                        a.push(b);
                        for (var json in jsondata.comments) {
                            var b = [];
                            for (var data in jsondata.comments[json]) {
                                b.push(jsondata.comments[json][data]);
                            }
                            a.push(b);
                        }
                        console.log(a);
                        arrayToTable(a);
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log("Error: " + errorThrown);
                    }
                });
            });
        </script>

        <script type="text/javascript">
            $("#admin-medias").submit(function (event) {
                event.preventDefault();

                $.ajax({
                    type: "POST",
                    url: "http://localhost:8080/MetroShare/webresources/admin/medias",
                    data: $("#admin-medias").serialize(),
                    success: function (data, textStatus, xhr) {
                        var jsondata = JSON.parse(data);
                        var a = [];
                        var b = [];
                        for (var data in jsondata.medias[0]) {
                            b.push(data);
                        }
                        a.push(b);
                        for (var json in jsondata.medias) {
                            var b = [];
                            for (var data in jsondata.medias[json]) {
                                if (data == "tags") {
                                    for (var tag in jsondata.medias[json][data]) {
                                        var c = [];
                                        for (var tagdata in jsondata.medias[json][data][tag]) {
                                            c.push(jsondata.medias[json][data][tag][tagdata]);
                                        }
                                        b.push(c);
                                    }
                                } else {
                                    b.push(jsondata.medias[json][data]);
                                }
                            }
                            a.push(b);
                        }
                        console.log(a);
                        arrayToTable(a);
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log("Error: " + errorThrown);
                    }
                });
            });
        </script>

        <script type="text/javascript">
            $("#admin-tags").submit(function (event) {
                event.preventDefault();

                $.ajax({
                    type: "POST",
                    url: "http://localhost:8080/MetroShare/webresources/admin/tags",
                    data: $("#admin-tags").serialize(),
                    success: function (data, textStatus, xhr) {
                        var jsondata = JSON.parse(data);
                        var a = [];
                        var b = [];
                        for (var data in jsondata.tags[0]) {
                            b.push(data);
                        }
                        a.push(b);
                        for (var json in jsondata.tags) {
                            var b = [];
                            for (var data in jsondata.tags[json]) {
                                b.push(jsondata.tags[json][data]);
                            }
                            a.push(b);
                        }
                        console.log(a);
                        arrayToTable(a);
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log("Error: " + errorThrown);
                    }
                });
            });
        </script>

        <script type="text/javascript">
            function arrayToTable(arrayToBeTable) {
                console.log(arrayToBeTable);
                var table = document.getElementById("tables");
                table.innerHTML = '';
                var thead = document.createElement("THEAD");
                var tbody = document.createElement("TBODY");
                var tr = document.createElement("TR");
                for (i = 0; i < arrayToBeTable.length; i++) {
                    if (i == 0) {
                        for (var header in arrayToBeTable[i]) {
                            var th = document.createElement("TH");
                            th.textContent = arrayToBeTable[i][header];
                            tr.appendChild(th);
                        }
                        thead.appendChild(tr);
                        table.appendChild(thead);
                    } else {
                        tr = document.createElement("TR");
                        for (var value in arrayToBeTable[i]) {
                            var th = document.createElement("TD");
                            th.textContent = arrayToBeTable[i][value];
                            tr.appendChild(th);
                        }
                        tbody.appendChild(tr);
                        table.appendChild(tbody);
                    }
                }
            }
        </script>
    </body>
</html>
